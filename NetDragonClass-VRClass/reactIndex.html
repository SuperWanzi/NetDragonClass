<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>VR创客教室</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
		<script src="js/lib/react.min.js"></script>
   		<script src="js/lib/react-dom.min.js"></script>
    	<script src="js/lib/browser.min.js"></script>
	</head>
	<body>
	</body>
</html>
<script type="text/javascript">
	function setNavHeight(){
		var contentHeight=document.getElementsByClassName("page-contents-wrap")[0].offsetHeight;
		var nav=document.getElementsByClassName("left-sidebar")[0];
		nav["style"]["height"]=contentHeight+"px";
		console.log("!")
	}
	window.onload=function(){
		setNavHeight();
		window.onresize = function(){
			setNavHeight();
		};
	}
</script>

<script type="text/babel">
	var WorkItem = React.createClass({
		getItemContent: function() {
			return(
				<div className="work-item">
					<div className="item-view">
						<img src="img/u=3827902191,936378654&fm=206&gp=0.jpg" title="李冉、涂佳佳、李婷、张婷、张三、李四、王小明、张三丰黎明" />
						<div className="author-info">
							<span className="fa fa-user-circle-o"></span>
							<span className="author-name">李冉、涂佳佳、李婷、张婷、张三、李四、王小明、张三丰黎明</span>
							<span className="create-time">2016/08/04 10:55</span>
						</div>
					</div>
					<div className="item-menu">
						<a className="menu-btn edit" href="#">
							<span className="fa fa-edit"></span>
							<p>编辑</p>
						</a>
						<a className="menu-btn play active" href="#">
							<span className="fa fa-play-circle-o"></span>
							<p>播放</p>
						</a>
						<a className="menu-btn trash" href="#">
							<span className="fa fa-trash"></span>
							<p>删除</p>
						</a>
					</div>
					<div className="works-title">
						郑和下西洋
					</div>
				</div>
			)
		},
		render: function() {
			return this.getItemContent();
		}
	});
	/*header部分*/
	var Header=React.createClass({
		render:function(){
			return (
				<header>
					<Logo />
					<HeaderRight />
				</header>
			);
		}
	});
	var Logo=React.createClass({
		render:function(){
			return (
				<div className="logo">
					<img src="img/101 logo.png"/>
					<p>VR创客教室</p>
				</div>
			)
		}
	});
	var HeaderRight=React.createClass({
		render:function(){
			var spanStyle = {
			   'user-select': 'none',
			   'position': 'absolute',
			   'right': 0
			};
			return (
				<div className="header-r">
					<div className="user-info">
						<div className="user-info-detail">
							<span className="fa fa-user-o"></span>
							用户:<span id="user-name">王小明</span>
							<span style={spanStyle}>
							|
							</span>
						</div>
						<div className="user-info-detail">
							<span className="fa fa-id-card-o"></span>
							身份:<span id="user-station">学生</span>
						</div>						
					</div>
					<button type="button" className="btn-set">
						设备选择
						<span className="fa fa-caret-down"></span>
					</button>
				</div>
			);
		}
	});
	
	var Page=React.createClass({
		render:function(){
			return(
				<div className="page-contents-wrap">
					<SiderBar />
					<PageContanior />
				</div>
			)
		}
	});
	var SiderBar=React.createClass({
		getInitialState:function(){
			return ({
				items: [{"全部课程":false},
				{"课程一：静夜思":false},
				{"课程二：红军长征":false},
				{"课程三：活字印刷术":false},
				{"课程四：郑和下西洋":false},
				{"课程五：梦想之家":false}]
			})
		},
		changeState:function(i){
			var arr=this.state.items;
			for(var item in arr){
				for(var val in arr[item]){
					arr[item][val]=false;
				}
			}
			for(var val in arr[i]){
				arr[i][val]=true;
			}
			this.setState({items:arr});
		},
		eachItem:function(title,i){
			var text="";
			var state=false;
			for(var val in title){
				text=val;
				state=title[val];
			};
			return (
				<SiderBarItem key={i} index={i} isActive={state}
					changeState={this.changeState}
				>{text}</SiderBarItem>
			)
		},
		render:function(){
			return (
				<div className="left-sidebar">
					<div id="left-sidebar-title">
						课程列表
					</div>
					<ul id="left-sidebar-list">
					{
							this.state.items.map(this.eachItem)
					}
					</ul>
				</div>
			)
		}
	});
	var SiderBarItem=React.createClass({
		getInitialState:function(){
			return ({isActive:false})
		},
		active:function(){
			this.props.changeState(this.props.index);
		},
		render:function(){
			return (
				<li className={this.props.isActive?"left-sidebar-item active":"left-sidebar-item"} onClick={this.active}>
					<span className="fa fa-book"></span>
					{this.props.children}
				</li>
			)
		}
	});
	var PageContanior=React.createClass({
		getInitialState:function(){
			return {
				mainState:true
			}
		},
		getModalStateMain:function(){
			if(this.state.mainState){
				return "flex"
			}else{
				return "none"
			}
		},
		getFexState:function(){
			if(this.state.mainState){
				return "block"
			}else{
				return "none"
			}
		},
		showForm:function(){
			this.setState({
				mainState:true
			})
		},
		closeMain:function(){
			this.setState({
				mainState:false
			})
		},
		render:function(){
			return (
				<div id="detail-contents">
					{/*详细信息顶部*/}
					<div id="detail-contents-top">
						
						<DetailNav showForm={this.showForm}/>
						<SearchItem />
						<div id="work-list">
							<WorkItem />
						</div>
						<ul className="page-list">
							<li className="page-item">
								<a href="#" className="page-select">&lt;</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">1</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">2</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select active">3</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">4</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">5</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">...</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">100</a>
							</li>
							<li className="page-item">
								<a href="#" className="page-select">&gt;</a>
							</li>
						</ul>
					</div>
					<Fex state={this.getFexState()} zindex="0" />
					<FormWork closeMain={this.closeMain} state={this.getModalStateMain()}/>
				</div>
			)
		}
	});
	var DetailNav=React.createClass({
		showForm:function(){
			this.props.showForm();
		},
		render:function(){
			return (
				<div id="detail-nav">
					<ul id="nav-list">
						<li className="nav-item active">
							<a href="#">我的作品</a>
						</li>
						<li className="nav-item">
							<a href="#">班级作品</a>
						</li>
					</ul>
					<div id="btn-group">
						<button type="button" className="btn-works" id="submit-works">
							<span className="fa fa-upload"></span>
							提交作品
						</button>
						<button type="button" className="btn-works" id="create-works" onClick={this.showForm}>
							<span className="fa fa-plus-circle"></span>
							新建作品
						</button>
					</div>
				</div>
			)
		}
	});
	
	var SearchItem=React.createClass({
		render:function(){
			return (
				<div className="user-search-box">
					<div id="user-search">
						<input type="text" name="search-text" id="search-text" placeholder="搜索资源" />
						<span className="fa fa-search"></span>
						<button type="button" id="btn-search">搜索</button>
					</div>
				</div>
			)
		}
	})
	var Fex=React.createClass({
		getInitialState:function(){
			return (
				{zindex:0}
			)
		},
		getStyle:function(){
			var fexStyle={
				'z-index':'99',
				'display':this.props.state
			};
			return fexStyle;
		},
		render:function(){
			var zindex=this.props.zindex;
			var state=this.props.state;
			console.log(state)
			return (
				<div id="background-fex" style={this.getStyle()}></div>
			)
		}
	});
	var FormWork=React.createClass({
		getInitialState:function(){
			return {
				author:[],
				authorState:false
			}
		},
		removeAuthor:function(key,value){
			var arr=this.state.author;
			arr.splice(key,1);
			this.setState(arr);
		},
		showAuthor:function(text,i){
			return (
				<div className="author-item" key={i} index={i}>
					<span className="author-name">{text}</span>
					<span className="fa fa-times remove-authot" onClick={this.removeAuthor.bind(this,i)}></span>
				</div>
			)
		},
		selectFile:function(){
			document.getElementById("ipf-image").click();
		},
		checkFile:function(){
			
		},
		closeModal:function(){
			this.props.closeMain()
		},
		getFexState:function(){
			if(this.state.authorState){
				return "block"
			}else{
				return "none"
			}
		},
		getStateAuthor:function(){
			if(this.state.authorState){
				return "flex"
			}else{
				return "none"
			}
		},
		showAuthorForm:function(){
			this.setState(
				{authorState:true}
			)
		},
		hideAuthorForm:function(){
			this.setState(
				{authorState:false}
			)
		},
		render:function(){
			var mainStyle={
				'display':this.props.state
			}
			return (
				<div className="modal-submit" id="modal-main" style={mainStyle}>
					<div className="modal-submit-box">
						<div id="modal-submit-main">
							<div className="modal-main-title">
								新建作品
								<span className="closeModal fa fa-times" onClick={this.closeModal}></span>
							</div>
							<form className="modal-main-content" action="#" method="post">
								<div className="sub-main-input">
									<span className="input-title">资源名称</span>
									<span className="input-text">
										<input type="text" name="name" id="ip-name" placeholder="请输入资源名称"/>
									</span>
								</div>
								<div className="sub-main-input" id="input-a">
									<span className="input-title">作者</span>
									<span className="input-text">
										<div className="input-author">
											{this.state.author.map(this.showAuthor)}
										</div>
										<div id="add-author">
											<span className="fa fa-plus-circle" onClick={this.showAuthorForm}></span>
										</div>
									</span>
								</div>
								<div className="sub-main-input">
									<span className="input-title">配图</span>
									<span className="input-text">
										<input type="text" name="image" id="ip-image" placeholder="点击上传图片" readOnly onClick={this.selectFile}/></span>
									<input style={{ "display": "none"}} type="file" name="image-file" id="ipf-image" onChange={this.checkFile}/>
								</div>
								<div className="sub-main-input">
									<span className="input-title">简介</span>
									<span className="input-text">
										<textarea name="about" id="ta-about"></textarea>
									</span>
								</div>
								<div className="sub-main-submit">
									{/*<input type="submit" name="fm-submit" id="fm-submit" defaultValue="确定提交" />*/}
									<button type="button" id="fm-submit">确定提交</button>
									<p>提交后显示在班级作品区</p>
								</div>
							</form>
							<Fex state={this.getFexState()}/>
							<FormAuthor state={this.getStateAuthor()} hideAuthorForm={this.hideAuthorForm}/>
						</div>
					</div>
				</div>
			)
		}
	});
	var FormAuthor=React.createClass({
		hideAuthorForm:function(){
			this.props.hideAuthorForm()
		},
		render:function(){
			var mainStyle={
				'display':this.props.state
			}
			return (	
				<div className="modal-submit" id="modal-author" style={mainStyle}>
					<div className="modal-submit-box">
						<div id="modal-submit-author">
							<div className="modal-main-title">
								班级成员
								<span className="closeModal fa fa-times" onClick={this.hideAuthorForm}></span>
							</div>
							<div className="modal-main-content">
								<div className="left-select">
									<div className="serch-student">
										<input type="text" id="in-search-stu" placeholder="搜索人名" />
										<span className="fa fa-search"></span>
									</div>
									<select id="dataAuthor" className="select-stu" multiple="multiple">
						
									</select>
								</div>
								<div className="menu-ctrl">
									<button type="button" className="btn-crtl active" id="btn-add">添加</button>
									<button type="button" className="btn-crtl" id="btn-remove">删除</button>
								</div>
								<div className="right-select">
									<select id="selectAuthor" className="select-stu" multiple="multiple">
						
									</select>
								</div>
								<div className="sub-main-submit author">
									<button type="button" className="btn-crtl active" id="add-confirm">确定</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				
			)
		}
	});
	ReactDOM.render(
		<div id="body">
			<Header />
			<Page />
		</div>,
		document.getElementsByTagName("body")[0]
	);
	
</script>
